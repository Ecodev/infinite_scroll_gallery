{namespace gallery=Tx_InfiniteScrollGallery_ViewHelpers}
<f:layout name="Default" />
<f:section name="main">
	<f:if condition="{loadJquery}">
		<gallery:script file="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" />
	</f:if>
	<gallery:script file="EXT:infinite_scroll_gallery/Resources/Public/JavaScript/JQuery/jquery.form.js" />
	<gallery:script file="EXT:infinite_scroll_gallery/Resources/Public/JavaScript/yoxview/yoxview-init.js" />
	<gallery:script file="EXT:infinite_scroll_gallery/Resources/Public/JavaScript/InfiniteScrollGallery.js" />
	<gallery:style file="EXT:infinite_scroll_gallery/Resources/Public/StyleSheets/InfiteScrollGallery.css" />
	<gallery:script>

		// Array containing images not displayed by defaut on this page
		infinitesSrollGallery.stockImages = <gallery:stockImage images="{stockImages}"
                                                                        maxWidth="{data.tx_infinitescrollgallery_imagemaximumwidth}"
                                                                        maxHeight="{data.tx_infinitescrollgallery_imagemaximumheight}" />
		//enable/disable scroll
		infinitesSrollGallery.enableMoreLoading = {enableMoreLoading}

	</gallery:script>
	<gallery:style>
		/* Defines width and height values dynamically */
		.tx-infinitscrollgallery-thumbnail {
			width: {data.tx_infinitescrollgallery_thumbnailmaximumwidth}px;
			height: {data.tx_infinitescrollgallery_thumbnailmaximumheight}px;
		}
	</gallery:style>
        <f:if condition="{showFilters}">
            <f:then />
            <f:else>
            <gallery:style>
                #tx-infinitescrollgallery-form {display: none;}
            </gallery:style>
            </f:else>
        </f:if>
	<f:form id="tx-infinitescrollgallery-form" method="GET">
		 <fieldset>
		 	<legend></legend>
			<f:form.hidden name="limit" id="tx-infinitescrollgallery-limit" value="{limit}" />
			<f:form.hidden name="offset" id="tx-infinitescrollgallery-offset" value="0" />
			<f:form.hidden name="recordUid" id="tx-infinitescrollgallery-recordUid" value="{recordUid}" />
			<f:form.hidden name="language" id="tx-infinitescrollgallery-language" value="{language}" />
			<span style="margin-right: 10px"><gallery:translate key="filter_by" />:</span>
			<label id="tx-infinitescrollgallery-label-tag" for="tx-infinitescrollgallery-tag"><gallery:translate key="filter_by_tag" /></label>

			<gallery:form.select name="tag"
					id="tx-infinitescrollgallery-tag"
					options="{tags}"
					emptyOption="{f:translate(key: 'tx_infinitescrollgallery_dropdown_tags')}"
					optionValueField="uid"
					optionLabelField="name"
					/>

			<input type="search"
					id="tx-infinitescrollgallery-search"
					placeholder="<gallery:translate key="search" />"
					value=""
					style="min-width: 13em;"
					class="search placeholder"
					name="tx_infinitescrollgallery_pi1[search]"
					/>
		</fieldset>
	</f:form>
	<div class="tx-infinitescrollgallery-main">
		<div class="yoxview">
			<ul>
				<f:for each="{images}" as="image">
                                    <f:if condition="{0:image.file_mime_type} == {0:'video/mp4'}">
                                        <f:then>
                                            <script type="text/javascript">
                                                        infinitesSrollGallery.videoPreview[{image.uid}] = {gallery:videoThumbnail(
                                                            path: '/fileadmin/user_upload/resources/{image.file_name}',
                                                            maxWidth: '{data.tx_infinitescrollgallery_thumbnailmaximumwidth}',
                                                            maxHeight: '{data.tx_infinitescrollgallery_thumbnailmaximumheight}',
                                                            interval: 10,
                                                            startTime: 15,
                                                            numberFrames: 5
                                                        )};
                                            </script>
                                            <li class="tx-infinitscrollgallery-thumbnail tx-infinitscrollgallery-thumbnail-video" id="video{image.uid}">
                                                <a href="{baseUri}fileadmin/user_upload/resources/{image.file_name}">
                                                    {f:image(src: 'typo3conf/ext/infinite_scroll_gallery/Resources/Public/Images/film_reel.gif',
                                                        alt: '{image.title}',
                                                        title: '{image.title}',
                                                        maxWidth: '{data.tx_infinitescrollgallery_thumbnailmaximumwidth}',
                                                        maxHeight: '{data.tx_infinitescrollgallery_thumbnailmaximumheight}')}
                                                </a>
                                            </li>
                                        </f:then>
                                        <f:else>
                                            <li class="tx-infinitscrollgallery-thumbnail">
                                                    <a href="{f:uri.image(src:'fileadmin/user_upload/resources/{image.file_name}',
                                                            maxWidth: '{data.tx_infinitescrollgallery_imagemaximumwidth}',
                                                            maxHeight: '{data.tx_infinitescrollgallery_imagemaximumheight}')}">
                                                            {f:image(src: 'fileadmin/user_upload/resources/{image.file_name}',
                                                                    alt: '{image.title}',
                                                                    title: '{image.title}',
                                                                    maxWidth: '{data.tx_infinitescrollgallery_thumbnailmaximumwidth}',
                                                                    maxHeight: '{data.tx_infinitescrollgallery_thumbnailmaximumheight}')}
                                                    </a>
                                            </li>
                                        </f:else>
                                    </f:if>
				</f:for>
			</ul>
		</div>
		<div class="tx-infinitescrollgallery-footer" style="clear: both">
			<div id="tx-infinitescrollgallery-recordnumber" <f:if condition="{numberOfVisibleImages} == {totalImages}">class="tx-infinitescrollgallery-hidden"</f:if>>
				<span id="tx-infinitescrollgallery-numberOfVisibleImages">{numberOfVisibleImages}</span> /
				<span id="tx-infinitescrollgallery-totalImages">{totalImages}</span>
			</div>
			<div class="tx-infinitescrollgallery-next" style="text-align: center">
				<!-- <a href="#">next &gt;</a> -->
			</div>
		</div>
		<div class="tx-infinitescrollgallery-loading"><f:image src="EXT:infinite_scroll_gallery/Resources/Public/Images/ajax-loader.gif" alt="loadding" width="200" /></div>
	</div>
</f:section>
